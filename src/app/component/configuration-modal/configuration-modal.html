@if(isOpenConfiguration){
<div
  class="fixed inset-0 bg-black/50 flex items-center justify-center z-50"
  (click)="close()"
  (keydown)="close()"
>
  <div
    class="bg-slate-800 text-white p-6 shadow-xl w-96 pixel-box"
    (click)="$event.stopPropagation()"
    (keydown)="$event.stopPropagation()"
  >
    <h2 class="text-xl font-bold mb-4">Cambiar color</h2>

    <label class="block mb-3 text-sm text-slate-300" for="selectedColor"
      >Selecciona un color:</label
    >

    <!-- Grid de colores -->
<div class="grid grid-cols-4 gap-3 mb-6">
  @for (color of colors; track $index) {
  <button
    type="button"
    class="color-option relative"
    [class.selected]="selectedColor === color"
    (click)="selectColor(color)"
  >
    <div
      class="w-full h-16 rounded-lg transition-transform hover:scale-105 pixel-box"
      [style.background-color]="color.color"
    ></div>

    @if (selectedColor === color) {
      <img
        src="assets/icon/check.png"
        alt="Seleccionado"
        class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-8 pointer-events-none"
      />
    }

    <span class="text-xs text-center mt-1 block text-slate-400">
      {{ color.name }}
    </span>
  </button>
  }
</div>


    <!-- Preview del color seleccionado -->
    @if(selectedColor) {
    <div class="mb-6 p-3 bg-slate-700 rounded-lg pixel-box">
      <p class="text-sm text-slate-300 mb-2">Color seleccionado:</p>
      <div class="flex items-center gap-3">
        <div
          class="w-12 h-12 rounded-lg border-2 border-slate-600 pixel-box-s"
          [style.background-color]="selectedColor.color"
        >
        </div>
        <span class="text-lg">{{ selectedColor.name }}</span>
      </div>
    </div>
    }

    <div class="flex justify-end gap-2">
      <button
        class="pixel-box px-4 py-2 bg-slate-600 rounded-lg hover:bg-slate-500 transition-colors"
        (click)="close()"
      >
        Cancelar
      </button>

      <button
        class="pixel-box px-4 py-2 bg-blue-600 rounded-lg hover:bg-blue-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
        [disabled]="!selectedColor"
        (click)="apply()"
      >
        Aplicar
      </button>
    </div>
  </div>
</div>
}
